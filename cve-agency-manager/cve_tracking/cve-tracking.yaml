# 匹配cve补丁信息的正则表达式
regex:
  # 匹配内容的类型的标签，当前只支持 "commit"/"pr"/"issue"
  - label: commit
    # 匹配特定类型内容的正则表达式，可以设置多个匹配规则
    regular:
      - http[s]?://(?:[-\w.\/;?])+(?:/rev|/ci|/commit[s]?)/(?:\?id=)?[0-9a-z]{8,40}
      - http[s]?://(?:[-\w.\/;=&?])+a=commit(?:[\w;&?])+h=[0-9a-z]{8,40}
  - label: pr
    regular:
      - http[s]?://(?:[-\w.\/;?])+(?:pull[s]?|merge_requests)/[1-9][0-9]*
  - label: issue
    regular:
      - http[s]?://(?:[-\w.\/;?])+issues/[0-9A-Z]+

# 查找cve漏洞修复的平台，例如 Debian、Bugzilla、Nvd等
platform:
  # The name of the platform, similar to a label
  # 平台的名称(必配项)
  - name: Cnnvd
    # Request address to find CVE information,{cve_num} is a placeholder for string substitution in Python
    # 查找cve详情信息的请求地址，“{cve_num}”是python中字符串替换的占位符(必配项)
    url: http://cnnvd.org.cn/web/vulnerability/queryLds.tag?qcvCnnvdid={cve_num}
    # 发送请求的方式，默认为get请求，还可以指定为post请求，当请求方式为get时，此处可不配置
    method: get
    # 若请求方式为post且存在请求体时，body为必填项，且必须为json格式，当请求方式为get时，此处可不配置
    body:
    # 解析响应体的方式，当前只支持“text”或“json”(必配项)
    format: text
    # 当请求无法直接获取cve信息时（根据页面中特定链接多次跳转），可以指定页面跳转的方式来获取进一步的信息
    redirct:
      # 跳转地址的前缀，一般情况下为跳转页面的域名，如果正则表达式匹配到的跳转地址中有完整的域名+路径，此配置项可以不填写
      - prefix: http://cnnvd.org.cn
        # 匹配页面跳转地址的正则表达式，如果匹配多个值，则获取最后一个匹配项
        regex: /web/xxk/ldxqById\.tag\?CNNVD=CNNVD[0-9-]+
        # 送请求的方法，默认为get请求，还可以指定为post请求，当请求为get时，此处可不配置
        method: get
        # 若请求方式为post且存在请求体时，body为必填项，且必须为json格式
        body:

  - name: Debian
    url: https://security-tracker.debian.org/tracker/{cve_num}
    format: text

  - name: Ubuntn
    url: https://ubuntu.com/security/{cve_num}
    format: text

  - name: Bugzilla
    url: https://bugzilla.redhat.com/rest/bug/{cve_num}/comment
    format: json

  - name: Nvd
    url: https://nvd.nist.gov/vuln/detail/{cve_num}
    format: text

  - name: Suse
    url: https://bugzilla.suse.com/show_bug.cgi?id={cve_num}
    format: text

# Private token for API access
# api访问时的私人令牌，当前只支持"gitee"/"github"/"gitlab"
authentication:
  # api名称，此值不可更改
  - name: gitee
    # 访问api的私人令牌，可以手动获取后更改
    token:
  - name: github
    token:
  - name: gitlab
    token: glpat-24DGxkuTA8nTR1YQsXvZ
