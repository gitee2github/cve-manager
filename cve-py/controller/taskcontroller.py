#!/usr/bin/python
# -*- coding: UTF-8 -*-

################################################################################
#
# Copyright (c) 2020 openEuler.org, Inc. All Rights Reserved
#
################################################################################
"""
Control task

Authors: xiaojianghui
Date:    10/22/2020 11:01 AM
"""

from tabletask import runtask, mappingtask, toexcel
from gitwebtask import genegroup, yamltask
from emailtask import sendingtask
from downloadtask import downloadfiletask
from deletetask import deletefiletask


def toexcelcontroller():
    """
    Query the data whose cve_status status is 3 or 4 in the
    database to generate excel Modify the status of cve_status to 3 or 4 to 5,
    indicating that it has been added to excel to be processed

    Returns:
        return None
    """
    toexcel.MysqlToExcel().generate_table()
    toexcel.MysqlToExcel().update_status()
    sendingtask.sending()


def runtabletask():
    """
    Parse the artificial CVE table, crawl the CVE official
    website data, and store it in the database
    return None
    """
    runtask.crawlWeb()


def runmappeingtask():
    """
    Parse the artificial CVE table, crawl the CVE
    official website data, and store it in the database
    return None
    """

    mappingtask.toMysql()


def gwcontroller():
    """
    Grab warehouse yaml data
    return None
    """

    genegroup.Command().handle()
    yamltask.Task().download()
    yamltask.Task().read()


def rundownloadtask():
    """
    download files
    return None
    """

    downloadfiletask.handle_one()
    downloadfiletask.handle_two()


def rundelfiletask():
    """
    Delete files older than one month
    return None
    """

    deletefiletask.deldir("./oldexcels")
