FROM golang:latest

MAINTAINER TommyLike<tommylikehu@gmail.com>

WORKDIR $GOPATH/src/cve-manager
ADD . $GOPATH/src/cve-manager
#WORKDIR $GOPATH/src/arvonblog
COPY ./conf/product_app.conf $GOPATH/src/cve-manager/conf/app.conf
RUN go get github.com/astaxie/beedb && go get github.com/astaxie/beego && go get github.com/astaxie/beego/orm && go get github.com/astaxie/beego/toolbox

RUN cd /go/src/gitee.com/openeuler/cve-manager && CGO_ENABLED=1 go build -v -o ./cve-manager main.go

EXPOSE 8080
ENTRYPOINT ["./cve-manager"]
#ENTRYPOINT ["./main"]

# build binary
#RUN mkdir -p /go/src/gitee.com/openeuler/cve-manager
#COPY . /go/src/gitee.com/openeuler/cve-manager
#RUN cd /go/src/gitee.com/openeuler/cve-manager && CGO_ENABLED=1 go build -v -o ./cve-manager main.go

# copy binary config and utils
#FROM golang:latest
#RUN mkdir -p /opt/app/ && mkdir -p /opt/app/conf/
#COPY ./conf/product_app.conf /opt/app/conf/app.conf
# overwrite config yaml
#COPY  --from=BUILDER /go/src/gitee.com/openeuler/cve-manager/cve-manager /opt/app

#WORKDIR /opt/app/
#ENTRYPOINT ["/opt/app/cve-manager"]