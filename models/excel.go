package models

import "github.com/astaxie/beego/orm"

//ExcelExport the export excel row content model
type ExcelExport struct {
	Num int64
	Score
	CveBrief           string `json:"cve_brief"`
	OwnedComponent     string `json:"owned_component"`
	SecID              int64  `json:"sec_id" orm:"column(sec_id)"`
	Introduction       string `json:"introduction"`
	Summary            string `json:"summary"`
	Theme              string `json:"theme"`
	Description        string `json:"description"`
	InfluenceComponent string `json:"influence_component" orm:"size(256);null;column(influence_component)"`
	AffectProduct      string `json:"affect_product"`
	ReferenceLink      string `json:"reference_link"`
	AffectStatus       string `json:"affect_status"`
	PublicDate         string `json:"public_date"`
	OpenEulerSANum     string `json:"openeuler_sa_num" orm:"size(128);column(openeuler_sa_num)"`
}

//ExcelPackage Released packages
type ExcelPackage struct {
	PubTime string
	Repo string
	Packages string
}

//Insert Insert a generated excel file record
func (er ExportRecord) Insert() error {
	o := orm.NewOrm()
	_, err := o.Insert(&er)
	return err
}

//QueryLast query the last excel record
func (er *ExportRecord) QueryLast() error {
	o := orm.NewOrm()
	err := o.QueryTable(er).OrderBy("-create_time").One(er)
	return err
}
//Update update by column name
func (er *ExportRecord) Update(field ...string) error {
	o := orm.NewOrm()
	_, err := o.Update(er, field...)
	return err
}
//Read read by column name
func (er *ExportRecord) Read(field ...string)  error{
	o := orm.NewOrm()
	return o.Read(er, field...)
}
