package controllers

import (
	"cvevulner/models"
	"github.com/astaxie/beego"
)

//FileController file operation routing processing
type FileController struct {
	beego.Controller
}

//DownloadLastExcel Download the latest excel file
// @router /lastExcel [get]
func (f *FileController) DownloadLastExcel() {
	er := models.ExportRecord{}
	err := er.QueryLast()
	if err != nil {
		_ = f.Ctx.Output.Body([]byte("no file "))
	}
	fp := "./" + er.FileName
	f.Ctx.Output.Download(fp, er.FileName)
}
