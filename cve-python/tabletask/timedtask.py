# -*- coding: UTF-8 -*-
import sys
sys.path.append(r"D:\Users\Administrator\PycharmProjects\work")
import os
import schedule
import time
from tabletask import runtask,exceltask,toexcel

def task():
    #判断newexcels中是否存在xlsx表格
    # while os.path.exists("../newexcels/b-l.rar.1599118583853.xlsx"):
    flag=os.path.exists("../newexcels/a-l.rar.1599118583853.xlsx")
    if flag:

        print("定时任务开始")
        runtask.crawlWeb()
        # #移动xlsx文件备份
        exceltask.move_file()
    else:
        print("excel文件不存在,手动加入excel文件")
    '''
    查询数据库cve_status的数据,并生成excel
    修改cve_status为3或者4的为5,表示已生成excel待处理
    '''
    toexcel.MysqlToExcel().generate_table()
    toexcel.MysqlToExcel().update_status()
schedule.every().day.at("10:29").do(task)
while True:
    schedule.run_pending()    #run_pending：运行所有可以运行的任务
    time.sleep(1)    #睡眠1秒

